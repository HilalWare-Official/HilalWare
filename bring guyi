local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

local whitelist = {}

-- GUI oluştur
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "WhitelistGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

local frame = Instance.new("Frame", screenGui)
frame.Size = UDim2.new(0, 250, 0, 300)
frame.Position = UDim2.new(0, 10, 0.5, -150)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.BorderSizePixel = 0

-- Yumuşak kenar
local corner = Instance.new("UICorner", frame)
corner.CornerRadius = UDim.new(0, 12)

-- Kaydırmalı alan
local scrollingFrame = Instance.new("ScrollingFrame", frame)
scrollingFrame.Size = UDim2.new(1, 0, 1, 0)
scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
scrollingFrame.ScrollBarThickness = 8
scrollingFrame.BackgroundTransparency = 1
scrollingFrame.BorderSizePixel = 0

local listLayout = Instance.new("UIListLayout", scrollingFrame)
listLayout.Padding = UDim.new(0, 5)
listLayout.SortOrder = Enum.SortOrder.LayoutOrder

-- Güncelleme fonksiyonu
local function updatePlayerList()
    for _, child in pairs(scrollingFrame:GetChildren()) do
        if child:IsA("Frame") then
            child:Destroy()
        end
    end

    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            local entry = Instance.new("Frame", scrollingFrame)
            entry.Size = UDim2.new(1, 0, 0, 30)
            entry.BackgroundColor3 = Color3.fromRGB(50, 50, 50)

            local corner = Instance.new("UICorner", entry)
            corner.CornerRadius = UDim.new(0, 6)

            local nameButton = Instance.new("TextButton", entry)
            nameButton.Size = UDim2.new(0.6, 0, 1, 0)
            nameButton.Text = player.Name
            nameButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
            nameButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            nameButton.BackgroundTransparency = whitelist[player.Name] and 0.2 or 0
            nameButton.BorderSizePixel = 0

            local innerCorner = Instance.new("UICorner", nameButton)
            innerCorner.CornerRadius = UDim.new(0, 6)

            nameButton.MouseButton1Click:Connect(function()
                whitelist[player.Name] = not whitelist[player.Name]
                nameButton.BackgroundTransparency = whitelist[player.Name] and 0.2 or 0
            end)

            local getirBtn = Instance.new("TextButton", entry)
            getirBtn.Size = UDim2.new(0.35, 0, 1, 0)
            getirBtn.Position = UDim2.new(0.65, 5, 0, 0)
            getirBtn.Text = "GETİR"
            getirBtn.BackgroundColor3 = Color3.fromRGB(100, 50, 50)
            getirBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
            getirBtn.BorderSizePixel = 0

            local getirCorner = Instance.new("UICorner", getirBtn)
            getirCorner.CornerRadius = UDim.new(0, 6)

            getirBtn.MouseButton1Click:Connect(function()
                local char = player.Character
                local myChar = LocalPlayer.Character
                if char and char:FindFirstChild("HumanoidRootPart") and myChar and myChar:FindFirstChild("HumanoidRootPart") then
                    char.HumanoidRootPart.CFrame = myChar.HumanoidRootPart.CFrame + Vector3.new(2, 0, -2)
                end
            end)
        end
    end

    task.wait()
    scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y + 10)
end

-- Oyuncular değişince güncelle
Players.PlayerAdded:Connect(updatePlayerList)
Players.PlayerRemoving:Connect(updatePlayerList)
updatePlayerList()

-- Whitelist’te olmayanları her an öldür
game:GetService("RunService").RenderStepped:Connect(function()
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and not whitelist[player.Name] then
            local char = player.Character
            if char and char:FindFirstChild("Humanoid") then
                char.Humanoid.Health = 0
            end
        end
    end
end)
